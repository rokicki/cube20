<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <title></title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<h1 id="golomb-rulers-pushing-the-limits">Golomb Rulers: Pushing the Limits</h1>
<p>Tomas Rokicki (rokicki@gmail.com) and Gil Dogon (gil.dogon@mobileye.com)</p>
<p>Our previous work extended the calculation of near-optimal rulers based on affine and projective planes through 40,000 marks. These constructions generate the best known rulers for all sizes in excess of 16 marks; to our knowledge, despite significant interest, no one has been able to find any Golomb ruler with more than 16 marks with length less than the best of that generated by the affine or projective plane construction. This leads to hypothesis A:</p>
<p>Hypothesis A: for all n &gt; 16, the optimal Golomb ruler can be generated by an affine plane or projective plane construction.</p>
<p>No counterexample to hypothesis A is known despite a great deal of CPU expended over the past several decades, not the least of which was the distributed.net's OGR-24 through OGR-28 efforts which have consumed thousands of CPU years over the past 16 years. Also, the search for Golomb rulers has been a central problem for constraint-based search for some time, with no counterexamples found.</p>
<p>The final length of the best rulers found were in general very close, and slightly less than, the number of marks squared. Rulers with n marks and of length less than n<sup>2</sup> are called subquadratic rulers. Previous work by Dimitromanolakis showed the existence of subquadratic rulers through size 65,000. This leads to hypothesis B:</p>
<p>Hypothesis B: subquadratic rulers exist for all n.</p>
<p>One measure of how good a Golomb ruler is, is how much better than quadratic it is. Let us define the quality b(R) of a ruler R with n marks and total length d as n-sqrt(d). If OGR(n) is the optimal Golomb ruler of length n, then assuming hypothesis B is true, b(OGR(n)) is positive for all n. Another question of interest is, how large can the quality b(OGR(n)) be?</p>
<p>Hypothesis C: b(OGR(n)) is unbounded.</p>
<p>This hypothesis was conjectured by Erdös and Turán in 1941.</p>
<h1 id="empirical-results">Empirical results</h1>
<p>The following two images and interactive graphs summarize the quality results we obtained for the three construction methods through rulers of size 40,000 marks. Click on the images for an interactive graph; select-drag a region to zoom in, and double-click to zoom back out.</p>
<p><a href="q3.html"><img src="q3.png"></a></p>
<p><a href="q.html"><img src="q.png"></a></p>
<h1 id="finding-subquadratic-rulers">Finding Subquadratic Rulers</h1>
<p>Using the programs created for our previous work, we set out to explore these hypotheses for larger values of n. First, we tried to extend the work of Dimitromanolakis past 65,000. There are three known asymptotically-optimal algebraic constructions: the Ruzsa construction, the affine plane construction, and the projective plane construction. The first two construction methods have very fast (linear time) modular ruler construction methods (Ruzsa trivially, the affine construction [see Lindstrom below]), but for the projective plane ruler construction only a quadratic algorithm is known. The affine plane construction usually generates better rulers than the Ruzsa construction, so we use that as our main workhorse. We did not consider all possible derived Golomb rulers but only scanned a modular Golomb ruler until we showed the existence of a subquadratic ruler for all sizes in the range between the generating prime power and the previous prime power. This very quickly covered the entire range from 40,000 through to 500,000 except for about eight gaps between prime powers.</p>
<p>For the larger gaps that caused more problems, we started with the projective plane construction rather than the affine plane construction; even though generating the modular ruler takes longer for the projective plane construction, the actual scanning of the derived rulers, which is has the dominant run time (cubic in n) can be done more rapidly.</p>
<h1 id="multiplicative-groups-for-faster-scanning">Multiplicative Groups for Faster Scanning</h1>
<p>When generating derived modular rulers from a given modular ruler, you multiply the original ruler by a value m that is relatively prime to the modulus of the rulers (and the multiplication is done modulo the modulus) and then sort the resulting values. So for instance, for the projective plane construction, with a prime of 13, the modulus is 13<sup>2</sup>+13+1 or 183, which is factored into 3*61. You would consider rulers generated by multiplying the original rulers by the values 2, 4, 5, 7, 8, 10, 11, and so on. The multiplication, remainder, and the sort operations are the most costly operations in the scan when you are focused on a small range of final Golomb rule sizes; we were focused on only the small range for which we had not already found subquadratic rulers.</p>
<p>Rather than considering the distinct multipliers sequentially, you can instead consider them in a sequence that emphasizes multiplication by small integers, especially 2 or 3. Given an already sorted set, you can perform multiplication, modulo, and sorting by such a small integer much more rapidly than the naive implementation. For the multiplication and modulo steps, you can instead use addition and subtraction, where the value to be subtracted changes only a small number of times throughout the range. The sort step can be done by merging a small number of already-sorted subranges. For instance, given the projective-plane-derived modular ruler</p>
<p>0 1 8 24 37 41 59 107 119 128 134 139 153 181</p>
<p>with the modulus 183, multiplication by two gives</p>
<p>0 2 16 48 74 82 118 214 238 256 268 278 306 362</p>
<p>The value to subtract to keep it in range is 0 for the first half (through 118) and then 183 for the rest, giving us</p>
<p>0 2 16 48 74 82 118 31 55 73 85 95 123 179</p>
<p>The sort step is just a simple merge of the two sorted subsequences, giving</p>
<p>0 2 16 31 48 55 73 74 82 85 95 118 123 179</p>
<p>For projective-plane-derived rulers, the modulo for a prime power p is p<sup>2</sup>+p+1, which is never divisible by 2, so most of the time the generation of the next derived ruler can use the multiplier 2. For affine-plane-derived rulers, the modulo for a prime power p is p<sup>2</sup>-1, which is usually divisible by 2 (except for when p is a power of 2) and usually divisible by 3 (since p<sup>2</sup>-1 is (p-1)*(p+1) and since p is usually not divisible by 3, one of p-1 or p+1 usually is) so the smallest multiplier we can frequently use is 5, and thus turns out to be significantly slower (at the sort/merge step) than 2.</p>
<p>For the example above, with p=13 and a modulus of 183, we only ever need use a multiplier of 2, as the first 20 powers of 2 mod 183 generate all necessary multipliers:</p>
<p>1 2 4 8 16 32 64 128 73 146 109 35 70 140 97 11 22 44 88 176</p>
<p>(The other 100 multipliers that are relatively prime to 183 generate equivalent rulers by symmetry; we omit the details.)</p>
<p>So even though generating the original modular Golomb ruler is slower with the projective plane construction, if we plan to scan a significant fraction of the possible generated rulers, the projective plane construction ends up being faster. Another benefit was the projective plane construction typically (about 2/3rds of the time) generated slightly shorter rulers.</p>
<h1 id="the-challenge-large-prime-power-gaps">The Challenge: Large Prime (Power) Gaps</h1>
<p>So for the gaps that turned out to be difficult, we used the projective plane construction. With this, we were able to cover all but one gap in the range through 500,000. The remaining gap was 492,116 through 492,118. In order to fully explore the projective plane construction, we had to construct all 39 billion possible different modular rulers and scan each of them for potential solutions. Next, we did the same for the affine plane construction, constructing and scanning all 10 billion possible different modular rulers. None of them were subquadratic for the three target mark counts given above.</p>
<p>This result is not completely surprising; the gap between the consecutive prime powers 492,113 and 492,227 is 114, which is a maximal gap (the first gap of that size or greater in the sequence of prime powers). The typical prime gap for primes around this size is ln(p) or about 14. (The projective plane construction for p=492,113 constructed subquadratic Golomb rulers for 492,113 and 492,114 marks.) Empirically, we see that the projective plane and affine plane constructions typically create subquadratic rulers only for values close to the prime power used to generate them (and for some trivially small values); for this maximal prime gap, the size of the prime gap was too large to span.</p>
<p><a href="howfarback.html"><img src="howfarback.png"></a></p>
<p>We did not evaluate the next prime power up (492,251) for this range because of the computational time required and because we believe it is extremely unlikely to generate subquadratic rulers that small, based on the relationship between the size of the range of subquadratic rulers generated and the prime power used to generate them.</p>
<p>So we have found for all sizes through 492,115 marks, a subquadratic Golomb ruler exists; for all sizes through 500,000 marks, only three values (492,116 through 492,118) do not have a proven subquadratic ruler. In addition, one of the following must be true:</p>
<p>Hypothesis A is false; there is some subquadratic ruler for 492,116 that is not generated by the projective plane or affine plane construction;</p>
<p>Hypothesis B is false; there is no subquadratic ruler for 492,116;</p>
<p>A subquadratic ruler for 492,116 can be constructed by the projective plane or affine plane construction for a prime power of 492,251 or greater.</p>
<p>Some bug exists in our programs. We have worked hard to avoid this, including completely separate implementations and comparing results.</p>
<p>We believe one of hypothesis A or B is false.</p>
<p>There has been much attention in the literature to using general optimization and search techniques to find Golomb rulers. So far these techniques have been shown to be effective only for a very small number of marks (through 16 to 20 marks), far short of the 492,116 marks we are interested in. Alternative algebraic or algorithmic construction methods are significantly inferior to the projective plane or affine plane construction (with the exception of one method, the Rusza method, which is only somewhat inferior and which we have also explored for the range in question without finding a subquadratic ruler).</p>
<p>Despite great interest, no construction techniques of comparable effectiveness have been found (the projective plane and affine plane construction techniques date back to 1938 and 1941, respectively).</p>
<h1 id="rulers-of-the-highest-quality">Rulers of the Highest Quality</h1>
<p>We now turn our attention to hypothesis C. Empirically we have found that powers of two greater than 2<sup>10</sup> generate rulers with the largest b(R). We do not yet have an explanation on why powers of two generate better Golomb rulers. The symmetry of the set of derived rulers for g=p<sup>n</sup> has order 4n (for the affine plane construction) and 6n (for the projective plane construction) and n is higher for the powers of two, so there are even fewer derived rulers to explore, and thus we would expect slightly worse rulers to be found. Yet, consistently, powers of two find Golomb rulers of higher quality than other prime powers; every record quality (by increasing n) between 4,000 and 40,000 was found by the affine or projective plane constructions starting from a modular ruler derived from a power of two.</p>
<p>We assume this continues for values of n greater than 40,000. We focused on these rulers to try to extend the known best b(R). We explored modular rulers of size 2<sup>16</sup>=65,536 through 2<sup>21</sup>=2,097,152. Since our purpose was to opportunistically look for rulers of high quality, rather than to prove an optimal quality, we only considered derived rulers (sub-rulers) whose length is close to the power of two (within 110). Further, for rulers larger than 32768, we only considered the projective plane and affine plane constructions (though we have not yet run the affine plane construction for sizes 2<sup>20</sup> or 2<sup>21</sup>). The number of rulers searched grows exponentially with n (by approximately a factor four), as for 2<sup>n</sup> , we have searched the full range of inequivalent possibilities for a modular ruler, which is phi(2<sup>2n</sup>+2<sup>n</sup>+1)/6n in the projective case, and phi(2<sup>2n</sup>-1)/4n in the affine case (PHI is Euler's totient function).</p>
<p>For the largest size, we were able to find a Golomb ruler at n=2,097,125 marks of length 4,397,762,317,463, for a b(R) of 40.758. Based on this result, and how much larger this is than the b(R) values for rulers smaller than 40,000, we suspect that b(OGR(n)) is indeed unbounded.</p>
<p>Record qualities by prime powers of two (question mark means we did not run the affine construction).</p>
<table>
<thead>
<tr class="header">
<th align="right">g</th>
<th align="right">n</th>
<th align="right">d</th>
<th align="right">b(R)</th>
<th align="center">type</th>
<th align="right"># rulers</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2048</td>
<td align="right">2046</td>
<td align="right">4124805</td>
<td align="right">15.04</td>
<td align="center">aff</td>
<td align="right">60016</td>
</tr>
<tr class="even">
<td align="right">2048</td>
<td align="right">2046</td>
<td align="right">4118063</td>
<td align="right">16.70</td>
<td align="center">proj</td>
<td align="right">54498</td>
</tr>
<tr class="odd">
<td align="right">4096</td>
<td align="right">4084</td>
<td align="right">16517156</td>
<td align="right">19.87</td>
<td align="center">aff</td>
<td align="right">138240</td>
</tr>
<tr class="even">
<td align="right">4096</td>
<td align="right">4091</td>
<td align="right">16583409</td>
<td align="right">18.73</td>
<td align="center">proj</td>
<td align="right">139968</td>
</tr>
<tr class="odd">
<td align="right">8192</td>
<td align="right">8182</td>
<td align="right">66601079</td>
<td align="right">21.05</td>
<td align="center">aff</td>
<td align="right">859950</td>
</tr>
<tr class="even">
<td align="right">8192</td>
<td align="right">8177</td>
<td align="right">66501869</td>
<td align="right">22.13</td>
<td align="center">proj</td>
<td align="right">728208</td>
</tr>
<tr class="odd">
<td align="right">16384</td>
<td align="right">16371</td>
<td align="right">267316415</td>
<td align="right">21.19</td>
<td align="center">aff</td>
<td align="right">2370816</td>
</tr>
<tr class="even">
<td align="right">16384</td>
<td align="right">16367</td>
<td align="right">267074038</td>
<td align="right">24.60</td>
<td align="center">proj</td>
<td align="right">1820448</td>
</tr>
<tr class="odd">
<td align="right">32768</td>
<td align="right">32750</td>
<td align="right">1070915788</td>
<td align="right">25.15</td>
<td align="center">aff</td>
<td align="right">8910000</td>
</tr>
<tr class="even">
<td align="right">32768</td>
<td align="right">32756</td>
<td align="right">1071073269</td>
<td align="right">28.74</td>
<td align="center">proj</td>
<td align="right">11748240</td>
</tr>
<tr class="odd">
<td align="right">65536</td>
<td align="right">65515</td>
<td align="right">4288124720</td>
<td align="right">31.23</td>
<td align="center">aff</td>
<td align="right">33554432</td>
</tr>
<tr class="even">
<td align="right">65536</td>
<td align="right">65523</td>
<td align="right">4289307076</td>
<td align="right">30.20</td>
<td align="center">proj</td>
<td align="right">23224320</td>
</tr>
<tr class="odd">
<td align="right">131072</td>
<td align="right">131042</td>
<td align="right">17162400535</td>
<td align="right">36.65</td>
<td align="center">aff</td>
<td align="right">168424950</td>
</tr>
<tr class="even">
<td align="right">131072</td>
<td align="right">131033</td>
<td align="right">17163471622</td>
<td align="right">33.57</td>
<td align="center">proj</td>
<td align="right">142888536</td>
</tr>
<tr class="odd">
<td align="right">262144</td>
<td align="right">262125</td>
<td align="right">68691708709</td>
<td align="right">33.97</td>
<td align="center">aff</td>
<td align="right">362797056</td>
</tr>
<tr class="even">
<td align="right">262144</td>
<td align="right">262122</td>
<td align="right">68685856466</td>
<td align="right">32.13</td>
<td align="center">proj</td>
<td align="right">424189440</td>
</tr>
<tr class="odd">
<td align="right">524288</td>
<td align="right">524252</td>
<td align="right">274802524432</td>
<td align="right">35.90</td>
<td align="center">aff</td>
<td align="right">2411191314</td>
</tr>
<tr class="even">
<td align="right">524288</td>
<td align="right">524242</td>
<td align="right">274803720226</td>
<td align="right">34.75</td>
<td align="center">proj</td>
<td align="right">2066689584</td>
</tr>
<tr class="odd">
<td align="right">1048576</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="center">aff</td>
<td align="right">5921280000</td>
</tr>
<tr class="even">
<td align="right">1048576</td>
<td align="right">1048529</td>
<td align="right">1099332551684</td>
<td align="right">38.39</td>
<td align="center">proj</td>
<td align="right">4704480000</td>
</tr>
<tr class="odd">
<td align="right">2097152</td>
<td align="right"></td>
<td align="right"></td>
<td align="right"></td>
<td align="center">aff</td>
<td align="right">28901432448</td>
</tr>
<tr class="even">
<td align="right">2097152</td>
<td align="right">2097125</td>
<td align="right">4397762317463</td>
<td align="right">40.76</td>
<td align="center">proj</td>
<td align="right">34426570752</td>
</tr>
</tbody>
</table>
<h1 id="references">References</h1>
<p>P. Erdös and P. Turán, On a Problem of Sidon in Additive Number Theory and on Some Related Problems</p>
<p>James Singer, <a href="http://www.ams.org/journals/tran/1938-043-03/S0002-9947-1938-1501951-4/S0002-9947-1938-1501951-4.pdf">A Theorem in Finite Projective Geometry and Some Applications to Number Theory</a></p>
<p>Konstantinos Drakakis, <a href="http://eeme.ucd.ie/~kdrakaka/work/publications/030.A_Review_Of_The_Available_Construction_Methods_For_Golomb_Rulers.pdf">A Review of the Available Construction Methods for Golomb Rulers</a></p>
<p>Apostolos Dimitromanolakis, <a href="http://www.cs.toronto.edu/~apostol/golomb/main.pdf">Analysis of the Golomb Ruler and the Sidon Set Problems, and Determination of Large, Near-Optimal Golomb Rulers</a></p>
<p>B. Lindström, Finding finite B2-sequences faster, Mathematics of Computation, 67 (1998), 1173-1178.</p>
<p>I. Z. Ruzsa, Solving a linear equation in a set of integers I, Acta Arithmetica, LXV (1993), 259-282.</p>
</body>
</html>
